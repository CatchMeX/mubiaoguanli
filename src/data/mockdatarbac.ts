// RBAC权限管理模拟数据
import { User } from '@/types';
import { users } from '@/data/mockData';

// 权限类型定义
export interface Permission {
  id: string;
  name: string;
  code: string;
  type: 'function' | 'data'; // 功能权限 | 数据权限
  level: 'menu' | 'page' | 'button'; // 权限层级：菜单 | 页面 | 按钮
  category: string; // 权限分类
  description?: string;
  parentId?: string;
  children?: Permission[];
}

// 角色定义
export interface Role {
  id: string;
  name: string;
  code: string; // 唯一标识符，不可修改
  description?: string;
  status: 'active' | 'inactive';
  isSystem: boolean; // 是否为系统内置角色
  isProtected: boolean; // 是否受保护（如超级管理员）
  permissions: string[]; // 权限ID数组
  memberCount: number; // 关联成员数量
  createdAt: string;
  updatedAt: string;
}

// 用户角色关联
export interface UserRole {
  id: string;
  userId: string;
  roleId: string;
  assignedBy: string; // 分配人ID
  assignedAt: string;
}

// 权限树形结构数据 - 根据实际菜单结构组织
export const permissions: Permission[] = [
  // 统计看板菜单
  {
    id: 'dashboard-menu',
    name: '统计看板',
    code: 'DASHBOARD_MENU',
    type: 'function',
    level: 'menu',
    category: 'dashboard',
    description: '统计看板菜单权限',
    children: [
      {
        id: 'dashboard-page',
        name: '统计看板',
        code: 'DASHBOARD_PAGE',
        type: 'function',
        level: 'page',
        category: 'dashboard',
        parentId: 'dashboard-menu',
        children: [
          {
            id: 'dashboard-export',
            name: '导出报表',
            code: 'DASHBOARD_EXPORT',
            type: 'function',
            level: 'button',
            category: 'dashboard',
            parentId: 'dashboard-page',
          },
          {
            id: 'dashboard-refresh',
            name: '刷新数据',
            code: 'DASHBOARD_REFRESH',
            type: 'function',
            level: 'button',
            category: 'dashboard',
            parentId: 'dashboard-page',
          },
        ],
      },
    ],
  },
  
  // 组织管理菜单
  {
    id: 'organization-menu',
    name: '组织管理',
    code: 'ORGANIZATION_MENU',
    type: 'function',
    level: 'menu',
    category: 'organization',
    description: '组织管理菜单权限',
    children: [
      // 部门管理页面
      {
        id: 'departments-page',
        name: '部门管理',
        code: 'DEPARTMENTS_PAGE',
        type: 'function',
        level: 'page',
        category: 'organization',
        parentId: 'organization-menu',
        children: [
          {
            id: 'departments-create',
            name: '创建部门',
            code: 'DEPARTMENTS_CREATE',
            type: 'function',
            level: 'button',
            category: 'organization',
            parentId: 'departments-page',
          },
          {
            id: 'departments-edit',
            name: '编辑部门',
            code: 'DEPARTMENTS_EDIT',
            type: 'function',
            level: 'button',
            category: 'organization',
            parentId: 'departments-page',
          },
          {
            id: 'departments-delete',
            name: '删除部门',
            code: 'DEPARTMENTS_DELETE',
            type: 'function',
            level: 'button',
            category: 'organization',
            parentId: 'departments-page',
          },
          {
            id: 'departments-move',
            name: '移动部门',
            code: 'DEPARTMENTS_MOVE',
            type: 'function',
            level: 'button',
            category: 'organization',
            parentId: 'departments-page',
          },
        ],
      },
      // 团队管理页面
      {
        id: 'teams-page',
        name: '团队管理',
        code: 'TEAMS_PAGE',
        type: 'function',
        level: 'page',
        category: 'organization',
        parentId: 'organization-menu',
        children: [
          {
            id: 'teams-create',
            name: '创建团队',
            code: 'TEAMS_CREATE',
            type: 'function',
            level: 'button',
            category: 'organization',
            parentId: 'teams-page',
          },
          {
            id: 'teams-edit',
            name: '编辑团队',
            code: 'TEAMS_EDIT',
            type: 'function',
            level: 'button',
            category: 'organization',
            parentId: 'teams-page',
          },
          {
            id: 'teams-delete',
            name: '删除团队',
            code: 'TEAMS_DELETE',
            type: 'function',
            level: 'button',
            category: 'organization',
            parentId: 'teams-page',
          },
          {
            id: 'teams-assign-members',
            name: '分配成员',
            code: 'TEAMS_ASSIGN_MEMBERS',
            type: 'function',
            level: 'button',
            category: 'organization',
            parentId: 'teams-page',
          },
        ],
      },
      // 权限管理页面
      {
        id: 'permissions-page',
        name: '权限管理',
        code: 'PERMISSIONS_PAGE',
        type: 'function',
        level: 'page',
        category: 'organization',
        parentId: 'organization-menu',
        children: [
          {
            id: 'roles-create',
            name: '创建角色',
            code: 'ROLES_CREATE',
            type: 'function',
            level: 'button',
            category: 'organization',
            parentId: 'permissions-page',
          },
          {
            id: 'roles-edit',
            name: '编辑角色',
            code: 'ROLES_EDIT',
            type: 'function',
            level: 'button',
            category: 'organization',
            parentId: 'permissions-page',
          },
          {
            id: 'roles-delete',
            name: '删除角色',
            code: 'ROLES_DELETE',
            type: 'function',
            level: 'button',
            category: 'organization',
            parentId: 'permissions-page',
          },
          {
            id: 'permissions-assign',
            name: '分配权限',
            code: 'PERMISSIONS_ASSIGN',
            type: 'function',
            level: 'button',
            category: 'organization',
            parentId: 'permissions-page',
          },
          {
            id: 'members-assign-roles',
            name: '分配成员角色',
            code: 'MEMBERS_ASSIGN_ROLES',
            type: 'function',
            level: 'button',
            category: 'organization',
            parentId: 'permissions-page',
          },
        ],
      },
      // 成员管理页面
      {
        id: 'members-page',
        name: '成员管理',
        code: 'MEMBERS_PAGE',
        type: 'function',
        level: 'page',
        category: 'organization',
        parentId: 'organization-menu',
        children: [
          {
            id: 'members-create',
            name: '创建成员',
            code: 'MEMBERS_CREATE',
            type: 'function',
            level: 'button',
            category: 'organization',
            parentId: 'members-page',
          },
          {
            id: 'members-edit',
            name: '编辑成员',
            code: 'MEMBERS_EDIT',
            type: 'function',
            level: 'button',
            category: 'organization',
            parentId: 'members-page',
          },
          {
            id: 'members-delete',
            name: '删除成员',
            code: 'MEMBERS_DELETE',
            type: 'function',
            level: 'button',
            category: 'organization',
            parentId: 'members-page',
          },
          {
            id: 'members-export',
            name: '导出成员',
            code: 'MEMBERS_EXPORT',
            type: 'function',
            level: 'button',
            category: 'organization',
            parentId: 'members-page',
          },
          {
            id: 'members-import',
            name: '导入成员',
            code: 'MEMBERS_IMPORT',
            type: 'function',
            level: 'button',
            category: 'organization',
            parentId: 'members-page',
          },
        ],
      },
    ],
  },

  // 客户供应商菜单
  {
    id: 'external-contacts-menu',
    name: '客户供应商',
    code: 'EXTERNAL_CONTACTS_MENU',
    type: 'function',
    level: 'menu',
    category: 'external',
    description: '客户供应商菜单权限',
    children: [
      // 客户管理页面
      {
        id: 'customers-page',
        name: '客户管理',
        code: 'CUSTOMERS_PAGE',
        type: 'function',
        level: 'page',
        category: 'external',
        parentId: 'external-contacts-menu',
        children: [
          {
            id: 'customers-create',
            name: '创建客户',
            code: 'CUSTOMERS_CREATE',
            type: 'function',
            level: 'button',
            category: 'external',
            parentId: 'customers-page',
          },
          {
            id: 'customers-edit',
            name: '编辑客户',
            code: 'CUSTOMERS_EDIT',
            type: 'function',
            level: 'button',
            category: 'external',
            parentId: 'customers-page',
          },
          {
            id: 'customers-delete',
            name: '删除客户',
            code: 'CUSTOMERS_DELETE',
            type: 'function',
            level: 'button',
            category: 'external',
            parentId: 'customers-page',
          },
          {
            id: 'customers-export',
            name: '导出客户',
            code: 'CUSTOMERS_EXPORT',
            type: 'function',
            level: 'button',
            category: 'external',
            parentId: 'customers-page',
          },
        ],
      },
      // 供应商管理页面
      {
        id: 'suppliers-page',
        name: '供应商管理',
        code: 'SUPPLIERS_PAGE',
        type: 'function',
        level: 'page',
        category: 'external',
        parentId: 'external-contacts-menu',
        children: [
          {
            id: 'suppliers-create',
            name: '创建供应商',
            code: 'SUPPLIERS_CREATE',
            type: 'function',
            level: 'button',
            category: 'external',
            parentId: 'suppliers-page',
          },
          {
            id: 'suppliers-edit',
            name: '编辑供应商',
            code: 'SUPPLIERS_EDIT',
            type: 'function',
            level: 'button',
            category: 'external',
            parentId: 'suppliers-page',
          },
          {
            id: 'suppliers-delete',
            name: '删除供应商',
            code: 'SUPPLIERS_DELETE',
            type: 'function',
            level: 'button',
            category: 'external',
            parentId: 'suppliers-page',
          },
          {
            id: 'suppliers-export',
            name: '导出供应商',
            code: 'SUPPLIERS_EXPORT',
            type: 'function',
            level: 'button',
            category: 'external',
            parentId: 'suppliers-page',
          },
        ],
      },
    ],
  },

  // 任务管理菜单
  {
    id: 'tasks-menu',
    name: '任务管理',
    code: 'TASKS_MENU',
    type: 'function',
    level: 'menu',
    category: 'task',
    description: '任务管理菜单权限',
    children: [
      {
        id: 'tasks-page',
        name: '任务管理',
        code: 'TASKS_PAGE',
        type: 'function',
        level: 'page',
        category: 'task',
        parentId: 'tasks-menu',
        children: [
          {
            id: 'tasks-create',
            name: '创建任务',
            code: 'TASKS_CREATE',
            type: 'function',
            level: 'button',
            category: 'task',
            parentId: 'tasks-page',
          },
          {
            id: 'tasks-edit',
            name: '编辑任务',
            code: 'TASKS_EDIT',
            type: 'function',
            level: 'button',
            category: 'task',
            parentId: 'tasks-page',
          },
          {
            id: 'tasks-delete',
            name: '删除任务',
            code: 'TASKS_DELETE',
            type: 'function',
            level: 'button',
            category: 'task',
            parentId: 'tasks-page',
          },
          {
            id: 'tasks-assign',
            name: '分配任务',
            code: 'TASKS_ASSIGN',
            type: 'function',
            level: 'button',
            category: 'task',
            parentId: 'tasks-page',
          },
          {
            id: 'tasks-complete',
            name: '完成任务',
            code: 'TASKS_COMPLETE',
            type: 'function',
            level: 'button',
            category: 'task',
            parentId: 'tasks-page',
          },
          {
            id: 'tasks-cancel',
            name: '取消任务',
            code: 'TASKS_CANCEL',
            type: 'function',
            level: 'button',
            category: 'task',
            parentId: 'tasks-page',
          },
          {
            id: 'tasks-export',
            name: '导出任务',
            code: 'TASKS_EXPORT',
            type: 'function',
            level: 'button',
            category: 'task',
            parentId: 'tasks-page',
          },
        ],
      },
    ],
  },

  // 目标管理菜单 - 根据实际菜单结构重新组织
  {
    id: 'goals-menu',
    name: '目标管理',
    code: 'GOALS_MENU',
    type: 'function',
    level: 'menu',
    category: 'goal',
    description: '目标管理菜单权限',
    children: [
      // 目标看板页面
      {
        id: 'goals-dashboard-page',
        name: '目标看板',
        code: 'GOALS_DASHBOARD_PAGE',
        type: 'function',
        level: 'page',
        category: 'goal',
        parentId: 'goals-menu',
        children: [
          {
            id: 'goals-dashboard-export',
            name: '导出看板',
            code: 'GOALS_DASHBOARD_EXPORT',
            type: 'function',
            level: 'button',
            category: 'goal',
            parentId: 'goals-dashboard-page',
          },
          {
            id: 'goals-dashboard-refresh',
            name: '刷新数据',
            code: 'GOALS_DASHBOARD_REFRESH',
            type: 'function',
            level: 'button',
            category: 'goal',
            parentId: 'goals-dashboard-page',
          },
        ],
      },
      // 公司年度目标页面
      {
        id: 'company-goals-page',
        name: '公司年度目标',
        code: 'COMPANY_GOALS_PAGE',
        type: 'function',
        level: 'page',
        category: 'goal',
        parentId: 'goals-menu',
        children: [
          {
            id: 'company-goals-create',
            name: '新增目标',
            code: 'COMPANY_GOALS_CREATE',
            type: 'function',
            level: 'button',
            category: 'goal',
            parentId: 'company-goals-page',
          },
          {
            id: 'company-goals-edit',
            name: '编辑目标',
            code: 'COMPANY_GOALS_EDIT',
            type: 'function',
            level: 'button',
            category: 'goal',
            parentId: 'company-goals-page',
          },
          {
            id: 'company-goals-delete',
            name: '删除目标',
            code: 'COMPANY_GOALS_DELETE',
            type: 'function',
            level: 'button',
            category: 'goal',
            parentId: 'company-goals-page',
          },
          {
            id: 'company-goals-export',
            name: '导出目标',
            code: 'COMPANY_GOALS_EXPORT',
            type: 'function',
            level: 'button',
            category: 'goal',
            parentId: 'company-goals-page',
          },
        ],
      },
      // 团队月度目标页面
      {
        id: 'team-goals-page',
        name: '团队月度目标',
        code: 'TEAM_GOALS_PAGE',
        type: 'function',
        level: 'page',
        category: 'goal',
        parentId: 'goals-menu',
        children: [
          {
            id: 'team-goals-create',
            name: '新增目标',
            code: 'TEAM_GOALS_CREATE',
            type: 'function',
            level: 'button',
            category: 'goal',
            parentId: 'team-goals-page',
          },
          {
            id: 'team-goals-edit',
            name: '编辑目标',
            code: 'TEAM_GOALS_EDIT',
            type: 'function',
            level: 'button',
            category: 'goal',
            parentId: 'team-goals-page',
          },
          {
            id: 'team-goals-delete',
            name: '删除目标',
            code: 'TEAM_GOALS_DELETE',
            type: 'function',
            level: 'button',
            category: 'goal',
            parentId: 'team-goals-page',
          },
          {
            id: 'team-goals-export',
            name: '导出目标',
            code: 'TEAM_GOALS_EXPORT',
            type: 'function',
            level: 'button',
            category: 'goal',
            parentId: 'team-goals-page',
          },
        ],
      },
      // 个人月度目标页面
      {
        id: 'personal-goals-page',
        name: '个人月度目标',
        code: 'PERSONAL_GOALS_PAGE',
        type: 'function',
        level: 'page',
        category: 'goal',
        parentId: 'goals-menu',
        children: [
          {
            id: 'personal-goals-create',
            name: '新增目标',
            code: 'PERSONAL_GOALS_CREATE',
            type: 'function',
            level: 'button',
            category: 'goal',
            parentId: 'personal-goals-page',
          },
          {
            id: 'personal-goals-edit',
            name: '编辑目标',
            code: 'PERSONAL_GOALS_EDIT',
            type: 'function',
            level: 'button',
            category: 'goal',
            parentId: 'personal-goals-page',
          },
          {
            id: 'personal-goals-delete',
            name: '删除目标',
            code: 'PERSONAL_GOALS_DELETE',
            type: 'function',
            level: 'button',
            category: 'goal',
            parentId: 'personal-goals-page',
          },
          {
            id: 'personal-goals-export',
            name: '导出目标',
            code: 'PERSONAL_GOALS_EXPORT',
            type: 'function',
            level: 'button',
            category: 'goal',
            parentId: 'personal-goals-page',
          },
        ],
      },
    ],
  },

  // 财务管理菜单
  {
    id: 'finance-menu',
    name: '财务管理',
    code: 'FINANCE_MENU',
    type: 'function',
    level: 'menu',
    category: 'finance',
    description: '财务管理菜单权限',
    children: [
      // 财务概览页面
      {
        id: 'finance-overview-page',
        name: '财务概览',
        code: 'FINANCE_OVERVIEW_PAGE',
        type: 'function',
        level: 'page',
        category: 'finance',
        parentId: 'finance-menu',
        children: [
          {
            id: 'finance-overview-export',
            name: '导出报表',
            code: 'FINANCE_OVERVIEW_EXPORT',
            type: 'function',
            level: 'button',
            category: 'finance',
            parentId: 'finance-overview-page',
          },
          {
            id: 'finance-overview-refresh',
            name: '刷新数据',
            code: 'FINANCE_OVERVIEW_REFRESH',
            type: 'function',
            level: 'button',
            category: 'finance',
            parentId: 'finance-overview-page',
          },
        ],
      },
      // 项目管理页面
      {
        id: 'finance-projects-page',
        name: '项目管理',
        code: 'FINANCE_PROJECTS_PAGE',
        type: 'function',
        level: 'page',
        category: 'finance',
        parentId: 'finance-menu',
        children: [
          {
            id: 'finance-projects-create',
            name: '创建项目',
            code: 'FINANCE_PROJECTS_CREATE',
            type: 'function',
            level: 'button',
            category: 'finance',
            parentId: 'finance-projects-page',
          },
          {
            id: 'finance-projects-edit',
            name: '编辑项目',
            code: 'FINANCE_PROJECTS_EDIT',
            type: 'function',
            level: 'button',
            category: 'finance',
            parentId: 'finance-projects-page',
          },
          {
            id: 'finance-projects-delete',
            name: '删除项目',
            code: 'FINANCE_PROJECTS_DELETE',
            type: 'function',
            level: 'button',
            category: 'finance',
            parentId: 'finance-projects-page',
          },
        ],
      },
      // 分类管理页面
      {
        id: 'finance-categories-page',
        name: '分类管理',
        code: 'FINANCE_CATEGORIES_PAGE',
        type: 'function',
        level: 'page',
        category: 'finance',
        parentId: 'finance-menu',
        children: [
          {
            id: 'finance-categories-create',
            name: '创建分类',
            code: 'FINANCE_CATEGORIES_CREATE',
            type: 'function',
            level: 'button',
            category: 'finance',
            parentId: 'finance-categories-page',
          },
          {
            id: 'finance-categories-edit',
            name: '编辑分类',
            code: 'FINANCE_CATEGORIES_EDIT',
            type: 'function',
            level: 'button',
            category: 'finance',
            parentId: 'finance-categories-page',
          },
          {
            id: 'finance-categories-delete',
            name: '删除分类',
            code: 'FINANCE_CATEGORIES_DELETE',
            type: 'function',
            level: 'button',
            category: 'finance',
            parentId: 'finance-categories-page',
          },
        ],
      },
      // 成本管理页面
      {
        id: 'finance-costs-page',
        name: '成本管理',
        code: 'FINANCE_COSTS_PAGE',
        type: 'function',
        level: 'page',
        category: 'finance',
        parentId: 'finance-menu',
        children: [
          {
            id: 'finance-costs-create',
            name: '创建成本',
            code: 'FINANCE_COSTS_CREATE',
            type: 'function',
            level: 'button',
            category: 'finance',
            parentId: 'finance-costs-page',
          },
          {
            id: 'finance-costs-edit',
            name: '编辑成本',
            code: 'FINANCE_COSTS_EDIT',
            type: 'function',
            level: 'button',
            category: 'finance',
            parentId: 'finance-costs-page',
          },
          {
            id: 'finance-costs-delete',
            name: '删除成本',
            code: 'FINANCE_COSTS_DELETE',
            type: 'function',
            level: 'button',
            category: 'finance',
            parentId: 'finance-costs-page',
          },
        ],
      },
      // 费用分摊页面
      {
        id: 'finance-allocations-page',
        name: '费用分摊',
        code: 'FINANCE_ALLOCATIONS_PAGE',
        type: 'function',
        level: 'page',
        category: 'finance',
        parentId: 'finance-menu',
        children: [
          {
            id: 'finance-allocations-create',
            name: '创建分摊',
            code: 'FINANCE_ALLOCATIONS_CREATE',
            type: 'function',
            level: 'button',
            category: 'finance',
            parentId: 'finance-allocations-page',
          },
          {
            id: 'finance-allocations-edit',
            name: '编辑分摊',
            code: 'FINANCE_ALLOCATIONS_EDIT',
            type: 'function',
            level: 'button',
            category: 'finance',
            parentId: 'finance-allocations-page',
          },
          {
            id: 'finance-allocations-delete',
            name: '删除分摊',
            code: 'FINANCE_ALLOCATIONS_DELETE',
            type: 'function',
            level: 'button',
            category: 'finance',
            parentId: 'finance-allocations-page',
          },
        ],
      },
      // 收入管理页面
      {
        id: 'finance-revenue-page',
        name: '收入管理',
        code: 'FINANCE_REVENUE_PAGE',
        type: 'function',
        level: 'page',
        category: 'finance',
        parentId: 'finance-menu',
        children: [
          {
            id: 'finance-revenue-create',
            name: '创建收入',
            code: 'FINANCE_REVENUE_CREATE',
            type: 'function',
            level: 'button',
            category: 'finance',
            parentId: 'finance-revenue-page',
          },
          {
            id: 'finance-revenue-edit',
            name: '编辑收入',
            code: 'FINANCE_REVENUE_EDIT',
            type: 'function',
            level: 'button',
            category: 'finance',
            parentId: 'finance-revenue-page',
          },
          {
            id: 'finance-revenue-delete',
            name: '删除收入',
            code: 'FINANCE_REVENUE_DELETE',
            type: 'function',
            level: 'button',
            category: 'finance',
            parentId: 'finance-revenue-page',
          },
          {
            id: 'finance-revenue-export',
            name: '导出收入',
            code: 'FINANCE_REVENUE_EXPORT',
            type: 'function',
            level: 'button',
            category: 'finance',
            parentId: 'finance-revenue-page',
          },
        ],
      },
      // 费用管理页面
      {
        id: 'finance-expenses-page',
        name: '费用管理',
        code: 'FINANCE_EXPENSES_PAGE',
        type: 'function',
        level: 'page',
        category: 'finance',
        parentId: 'finance-menu',
        children: [
          {
            id: 'finance-expenses-create',
            name: '创建费用',
            code: 'FINANCE_EXPENSES_CREATE',
            type: 'function',
            level: 'button',
            category: 'finance',
            parentId: 'finance-expenses-page',
          },
          {
            id: 'finance-expenses-edit',
            name: '编辑费用',
            code: 'FINANCE_EXPENSES_EDIT',
            type: 'function',
            level: 'button',
            category: 'finance',
            parentId: 'finance-expenses-page',
          },
          {
            id: 'finance-expenses-delete',
            name: '删除费用',
            code: 'FINANCE_EXPENSES_DELETE',
            type: 'function',
            level: 'button',
            category: 'finance',
            parentId: 'finance-expenses-page',
          },
          {
            id: 'finance-expenses-approve',
            name: '审批费用',
            code: 'FINANCE_EXPENSES_APPROVE',
            type: 'function',
            level: 'button',
            category: 'finance',
            parentId: 'finance-expenses-page',
          },
          {
            id: 'finance-expenses-export',
            name: '导出费用',
            code: 'FINANCE_EXPENSES_EXPORT',
            type: 'function',
            level: 'button',
            category: 'finance',
            parentId: 'finance-expenses-page',
          },
        ],
      },
      // 往来管理页面
      {
        id: 'finance-accounts-page',
        name: '往来管理',
        code: 'FINANCE_ACCOUNTS_PAGE',
        type: 'function',
        level: 'page',
        category: 'finance',
        parentId: 'finance-menu',
        children: [
          {
            id: 'finance-accounts-create',
            name: '创建往来',
            code: 'FINANCE_ACCOUNTS_CREATE',
            type: 'function',
            level: 'button',
            category: 'finance',
            parentId: 'finance-accounts-page',
          },
          {
            id: 'finance-accounts-edit',
            name: '编辑往来',
            code: 'FINANCE_ACCOUNTS_EDIT',
            type: 'function',
            level: 'button',
            category: 'finance',
            parentId: 'finance-accounts-page',
          },
          {
            id: 'finance-accounts-delete',
            name: '删除往来',
            code: 'FINANCE_ACCOUNTS_DELETE',
            type: 'function',
            level: 'button',
            category: 'finance',
            parentId: 'finance-accounts-page',
          },
          {
            id: 'finance-accounts-export',
            name: '导出往来',
            code: 'FINANCE_ACCOUNTS_EXPORT',
            type: 'function',
            level: 'button',
            category: 'finance',
            parentId: 'finance-accounts-page',
          },
        ],
      },
    ],
  },

  // 资产管理菜单
  {
    id: 'assets-menu',
    name: '资产管理',
    code: 'ASSETS_MENU',
    type: 'function',
    level: 'menu',
    category: 'asset',
    description: '资产管理菜单权限',
    children: [
      // 资产概览页面
      {
        id: 'assets-overview-page',
        name: '资产概览',
        code: 'ASSETS_OVERVIEW_PAGE',
        type: 'function',
        level: 'page',
        category: 'asset',
        parentId: 'assets-menu',
        children: [
          {
            id: 'assets-overview-export',
            name: '导出报表',
            code: 'ASSETS_OVERVIEW_EXPORT',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-overview-page',
          },
          {
            id: 'assets-overview-refresh',
            name: '刷新数据',
            code: 'ASSETS_OVERVIEW_REFRESH',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-overview-page',
          },
        ],
      },
      // 资产分类页面
      {
        id: 'assets-categories-page',
        name: '资产分类',
        code: 'ASSETS_CATEGORIES_PAGE',
        type: 'function',
        level: 'page',
        category: 'asset',
        parentId: 'assets-menu',
        children: [
          {
            id: 'assets-categories-create',
            name: '创建分类',
            code: 'ASSETS_CATEGORIES_CREATE',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-categories-page',
          },
          {
            id: 'assets-categories-edit',
            name: '编辑分类',
            code: 'ASSETS_CATEGORIES_EDIT',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-categories-page',
          },
          {
            id: 'assets-categories-delete',
            name: '删除分类',
            code: 'ASSETS_CATEGORIES_DELETE',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-categories-page',
          },
        ],
      },
      // 存放位置页面
      {
        id: 'assets-locations-page',
        name: '存放位置',
        code: 'ASSETS_LOCATIONS_PAGE',
        type: 'function',
        level: 'page',
        category: 'asset',
        parentId: 'assets-menu',
        children: [
          {
            id: 'assets-locations-create',
            name: '创建位置',
            code: 'ASSETS_LOCATIONS_CREATE',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-locations-page',
          },
          {
            id: 'assets-locations-edit',
            name: '编辑位置',
            code: 'ASSETS_LOCATIONS_EDIT',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-locations-page',
          },
          {
            id: 'assets-locations-delete',
            name: '删除位置',
            code: 'ASSETS_LOCATIONS_DELETE',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-locations-page',
          },
        ],
      },
      // 供应商管理页面
      {
        id: 'assets-suppliers-page',
        name: '供应商管理',
        code: 'ASSETS_SUPPLIERS_PAGE',
        type: 'function',
        level: 'page',
        category: 'asset',
        parentId: 'assets-menu',
        children: [
          {
            id: 'assets-suppliers-create',
            name: '创建供应商',
            code: 'ASSETS_SUPPLIERS_CREATE',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-suppliers-page',
          },
          {
            id: 'assets-suppliers-edit',
            name: '编辑供应商',
            code: 'ASSETS_SUPPLIERS_EDIT',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-suppliers-page',
          },
          {
            id: 'assets-suppliers-delete',
            name: '删除供应商',
            code: 'ASSETS_SUPPLIERS_DELETE',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-suppliers-page',
          },
        ],
      },
      // 品牌管理页面
      {
        id: 'assets-brands-page',
        name: '品牌管理',
        code: 'ASSETS_BRANDS_PAGE',
        type: 'function',
        level: 'page',
        category: 'asset',
        parentId: 'assets-menu',
        children: [
          {
            id: 'assets-brands-create',
            name: '创建品牌',
            code: 'ASSETS_BRANDS_CREATE',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-brands-page',
          },
          {
            id: 'assets-brands-edit',
            name: '编辑品牌',
            code: 'ASSETS_BRANDS_EDIT',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-brands-page',
          },
          {
            id: 'assets-brands-delete',
            name: '删除品牌',
            code: 'ASSETS_BRANDS_DELETE',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-brands-page',
          },
        ],
      },
      // 资产清单页面
      {
        id: 'assets-list-page',
        name: '资产清单',
        code: 'ASSETS_LIST_PAGE',
        type: 'function',
        level: 'page',
        category: 'asset',
        parentId: 'assets-menu',
        children: [
          {
            id: 'assets-list-create',
            name: '创建资产',
            code: 'ASSETS_LIST_CREATE',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-list-page',
          },
          {
            id: 'assets-list-edit',
            name: '编辑资产',
            code: 'ASSETS_LIST_EDIT',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-list-page',
          },
          {
            id: 'assets-list-delete',
            name: '删除资产',
            code: 'ASSETS_LIST_DELETE',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-list-page',
          },
          {
            id: 'assets-list-export',
            name: '导出资产',
            code: 'ASSETS_LIST_EXPORT',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-list-page',
          },
        ],
      },
      // 资产调拨页面
      {
        id: 'assets-movements-page',
        name: '资产调拨',
        code: 'ASSETS_MOVEMENTS_PAGE',
        type: 'function',
        level: 'page',
        category: 'asset',
        parentId: 'assets-menu',
        children: [
          {
            id: 'assets-movements-create',
            name: '创建调拨',
            code: 'ASSETS_MOVEMENTS_CREATE',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-movements-page',
          },
          {
            id: 'assets-movements-approve',
            name: '审批调拨',
            code: 'ASSETS_MOVEMENTS_APPROVE',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-movements-page',
          },
          {
            id: 'assets-movements-cancel',
            name: '取消调拨',
            code: 'ASSETS_MOVEMENTS_CANCEL',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-movements-page',
          },
        ],
      },
      // 维护管理页面
      {
        id: 'assets-maintenance-page',
        name: '维护管理',
        code: 'ASSETS_MAINTENANCE_PAGE',
        type: 'function',
        level: 'page',
        category: 'asset',
        parentId: 'assets-menu',
        children: [
          {
            id: 'assets-maintenance-create',
            name: '创建维护',
            code: 'ASSETS_MAINTENANCE_CREATE',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-maintenance-page',
          },
          {
            id: 'assets-maintenance-complete',
            name: '完成维护',
            code: 'ASSETS_MAINTENANCE_COMPLETE',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-maintenance-page',
          },
          {
            id: 'assets-maintenance-cancel',
            name: '取消维护',
            code: 'ASSETS_MAINTENANCE_CANCEL',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-maintenance-page',
          },
        ],
      },
      // 资产处置页面
      {
        id: 'assets-disposal-page',
        name: '资产处置',
        code: 'ASSETS_DISPOSAL_PAGE',
        type: 'function',
        level: 'page',
        category: 'asset',
        parentId: 'assets-menu',
        children: [
          {
            id: 'assets-disposal-create',
            name: '创建处置',
            code: 'ASSETS_DISPOSAL_CREATE',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-disposal-page',
          },
          {
            id: 'assets-disposal-approve',
            name: '审批处置',
            code: 'ASSETS_DISPOSAL_APPROVE',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-disposal-page',
          },
          {
            id: 'assets-disposal-complete',
            name: '完成处置',
            code: 'ASSETS_DISPOSAL_COMPLETE',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-disposal-page',
          },
        ],
      },
      // 盘点管理页面
      {
        id: 'assets-inventory-page',
        name: '盘点管理',
        code: 'ASSETS_INVENTORY_PAGE',
        type: 'function',
        level: 'page',
        category: 'asset',
        parentId: 'assets-menu',
        children: [
          {
            id: 'assets-inventory-create',
            name: '创建盘点',
            code: 'ASSETS_INVENTORY_CREATE',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-inventory-page',
          },
          {
            id: 'assets-inventory-execute',
            name: '执行盘点',
            code: 'ASSETS_INVENTORY_EXECUTE',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-inventory-page',
          },
          {
            id: 'assets-inventory-complete',
            name: '完成盘点',
            code: 'ASSETS_INVENTORY_COMPLETE',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-inventory-page',
          },
        ],
      },
      // 资产报表页面
      {
        id: 'assets-reports-page',
        name: '资产报表',
        code: 'ASSETS_REPORTS_PAGE',
        type: 'function',
        level: 'page',
        category: 'asset',
        parentId: 'assets-menu',
        children: [
          {
            id: 'assets-reports-generate',
            name: '生成报表',
            code: 'ASSETS_REPORTS_GENERATE',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-reports-page',
          },
          {
            id: 'assets-reports-export',
            name: '导出报表',
            code: 'ASSETS_REPORTS_EXPORT',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-reports-page',
          },
        ],
      },
      // 采购订单页面
      {
        id: 'assets-procurement-orders-page',
        name: '采购订单',
        code: 'ASSETS_PROCUREMENT_ORDERS_PAGE',
        type: 'function',
        level: 'page',
        category: 'asset',
        parentId: 'assets-menu',
        children: [
          {
            id: 'assets-procurement-orders-create',
            name: '创建订单',
            code: 'ASSETS_PROCUREMENT_ORDERS_CREATE',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-procurement-orders-page',
          },
          {
            id: 'assets-procurement-orders-edit',
            name: '编辑订单',
            code: 'ASSETS_PROCUREMENT_ORDERS_EDIT',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-procurement-orders-page',
          },
          {
            id: 'assets-procurement-orders-approve',
            name: '审批订单',
            code: 'ASSETS_PROCUREMENT_ORDERS_APPROVE',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-procurement-orders-page',
          },
          {
            id: 'assets-procurement-orders-cancel',
            name: '取消订单',
            code: 'ASSETS_PROCUREMENT_ORDERS_CANCEL',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-procurement-orders-page',
          },
        ],
      },
      // 入库管理页面
      {
        id: 'assets-procurement-receipts-page',
        name: '入库管理',
        code: 'ASSETS_PROCUREMENT_RECEIPTS_PAGE',
        type: 'function',
        level: 'page',
        category: 'asset',
        parentId: 'assets-menu',
        children: [
          {
            id: 'assets-procurement-receipts-create',
            name: '创建入库',
            code: 'ASSETS_PROCUREMENT_RECEIPTS_CREATE',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-procurement-receipts-page',
          },
          {
            id: 'assets-procurement-receipts-confirm',
            name: '确认入库',
            code: 'ASSETS_PROCUREMENT_RECEIPTS_CONFIRM',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-procurement-receipts-page',
          },
          {
            id: 'assets-procurement-receipts-cancel',
            name: '取消入库',
            code: 'ASSETS_PROCUREMENT_RECEIPTS_CANCEL',
            type: 'function',
            level: 'button',
            category: 'asset',
            parentId: 'assets-procurement-receipts-page',
          },
        ],
      },
    ],
  },

  // 数据权限
  {
    id: 'data-permissions',
    name: '数据权限',
    code: 'DATA_PERMISSIONS',
    type: 'data',
    level: 'menu',
    category: 'data',
    description: '数据访问范围权限',
    children: [
      {
        id: 'data-all',
        name: '全部数据',
        code: 'DATA_ALL',
        type: 'data',
        level: 'page',
        category: 'data',
        parentId: 'data-permissions',
        description: '可访问所有数据',
      },
      {
        id: 'data-department',
        name: '本部门数据',
        code: 'DATA_DEPARTMENT',
        type: 'data',
        level: 'page',
        category: 'data',
        parentId: 'data-permissions',
        description: '只能访问本部门数据',
      },
      {
        id: 'data-team',
        name: '本团队数据',
        code: 'DATA_TEAM',
        type: 'data',
        level: 'page',
        category: 'data',
        parentId: 'data-permissions',
        description: '只能访问本团队数据',
      },
      {
        id: 'data-self',
        name: '个人数据',
        code: 'DATA_SELF',
        type: 'data',
        level: 'page',
        category: 'data',
        parentId: 'data-permissions',
        description: '只能访问个人数据',
      },
    ],
  },
];

// 角色数据 - 更新权限ID以匹配新的权限结构
export const roles: Role[] = [
  {
    id: 'super-admin',
    name: '超级管理员',
    code: 'SUPER_ADMIN',
    description: '系统超级管理员，拥有所有权限',
    status: 'active',
    isSystem: true,
    isProtected: true,
    permissions: permissions.flatMap(p => [p.id, ...(p.children?.flatMap(c => [c.id, ...(c.children?.map(cc => cc.id) || [])]) || [])]),
    memberCount: 1,
    createdAt: '2024-01-01T00:00:00.000Z',
    updatedAt: '2024-01-01T00:00:00.000Z',
  },
  {
    id: 'admin',
    name: '系统管理员',
    code: 'ADMIN',
    description: '系统管理员，负责日常管理工作',
    status: 'active',
    isSystem: true,
    isProtected: false,
    permissions: [
      'dashboard-menu', 'dashboard-page', 'dashboard-export', 'dashboard-refresh',
      'organization-menu', 'departments-page', 'departments-create', 'departments-edit', 'departments-move',
      'teams-page', 'teams-create', 'teams-edit', 'teams-assign-members',
      'permissions-page', 'roles-create', 'roles-edit', 'permissions-assign', 'members-assign-roles',
      'members-page', 'members-create', 'members-edit', 'members-export', 'members-import',
      'external-contacts-menu', 'customers-page', 'customers-create', 'customers-edit', 'customers-export',
      'suppliers-page', 'suppliers-create', 'suppliers-edit', 'suppliers-export',
      'tasks-menu', 'tasks-page', 'tasks-create', 'tasks-edit', 'tasks-assign', 'tasks-complete', 'tasks-export',
      'goals-menu', 'goals-dashboard-page', 'goals-dashboard-export', 'goals-dashboard-refresh',
      'company-goals-page', 'company-goals-create', 'company-goals-edit', 'company-goals-export',
      'team-goals-page', 'team-goals-create', 'team-goals-edit', 'team-goals-export',
      'personal-goals-page', 'personal-goals-create', 'personal-goals-edit', 'personal-goals-export',
      'finance-menu', 'finance-overview-page', 'finance-overview-export', 'finance-overview-refresh',
      'finance-revenue-page', 'finance-revenue-create', 'finance-revenue-edit', 'finance-revenue-export',
      'finance-expenses-page', 'finance-expenses-create', 'finance-expenses-edit', 'finance-expenses-approve', 'finance-expenses-export',
      'assets-menu', 'assets-overview-page', 'assets-overview-export', 'assets-overview-refresh',
      'assets-list-page', 'assets-list-create', 'assets-list-edit', 'assets-list-export',
      'data-all',
    ],
    memberCount: 2,
    createdAt: '2024-01-01T00:00:00.000Z',
    updatedAt: '2024-01-01T00:00:00.000Z',
  },
  {
    id: 'department-manager',
    name: '部门经理',
    code: 'DEPT_MANAGER',
    description: '部门经理，管理本部门事务',
    status: 'active',
    isSystem: false,
    isProtected: false,
    permissions: [
      'dashboard-menu', 'dashboard-page', 'dashboard-refresh',
      'organization-menu', 'members-page', 'teams-page', 'teams-create', 'teams-edit', 'teams-assign-members',
      'tasks-menu', 'tasks-page', 'tasks-create', 'tasks-edit', 'tasks-assign', 'tasks-complete', 'tasks-export',
      'goals-menu', 'goals-dashboard-page', 'goals-dashboard-refresh',
      'team-goals-page', 'team-goals-create', 'team-goals-edit', 'team-goals-export',
      'personal-goals-page', 'personal-goals-create', 'personal-goals-edit', 'personal-goals-export',
      'finance-menu', 'finance-overview-page', 'finance-revenue-page', 'finance-revenue-create', 'finance-revenue-edit',
      'finance-expenses-page', 'finance-expenses-create', 'finance-expenses-edit', 'finance-expenses-approve',
      'assets-menu', 'assets-overview-page', 'assets-list-page', 'assets-list-create', 'assets-list-edit',
      'data-department',
    ],
    memberCount: 4,
    createdAt: '2024-01-01T00:00:00.000Z',
    updatedAt: '2024-01-01T00:00:00.000Z',
  },
  {
    id: 'team-leader',
    name: '团队负责人',
    code: 'TEAM_LEADER',
    description: '团队负责人，管理团队日常工作',
    status: 'active',
    isSystem: false,
    isProtected: false,
    permissions: [
      'dashboard-menu', 'dashboard-page',
      'organization-menu', 'members-page',
      'tasks-menu', 'tasks-page', 'tasks-create', 'tasks-edit', 'tasks-assign', 'tasks-complete',
      'goals-menu', 'goals-dashboard-page',
      'team-goals-page', 'team-goals-create', 'team-goals-edit',
      'personal-goals-page', 'personal-goals-create', 'personal-goals-edit',
      'finance-menu', 'finance-overview-page', 'finance-revenue-page', 'finance-expenses-page',
      'assets-menu', 'assets-overview-page', 'assets-list-page',
      'data-team',
    ],
    memberCount: 6,
    createdAt: '2024-01-01T00:00:00.000Z',
    updatedAt: '2024-01-01T00:00:00.000Z',
  },
  {
    id: 'employee',
    name: '普通员工',
    code: 'EMPLOYEE',
    description: '普通员工，基础权限',
    status: 'active',
    isSystem: false,
    isProtected: false,
    permissions: [
      'dashboard-menu', 'dashboard-page',
      'organization-menu', 'members-page',
      'tasks-menu', 'tasks-page', 'tasks-complete',
      'goals-menu', 'goals-dashboard-page',
      'personal-goals-page', 'personal-goals-create', 'personal-goals-edit',
      'finance-menu', 'finance-overview-page', 'finance-revenue-page', 'finance-expenses-page',
      'assets-menu', 'assets-overview-page', 'assets-list-page',
      'data-self',
    ],
    memberCount: 12,
    createdAt: '2024-01-01T00:00:00.000Z',
    updatedAt: '2024-01-01T00:00:00.000Z',
  },
  {
    id: 'finance-manager',
    name: '财务经理',
    code: 'FINANCE_MANAGER',
    description: '财务经理，负责财务管理',
    status: 'active',
    isSystem: false,
    isProtected: false,
    permissions: [
      'dashboard-menu', 'dashboard-page', 'dashboard-export',
      'organization-menu', 'members-page',
      'external-contacts-menu', 'customers-page', 'customers-create', 'customers-edit', 'customers-delete', 'customers-export',
      'suppliers-page', 'suppliers-create', 'suppliers-edit', 'suppliers-delete', 'suppliers-export',
      'tasks-menu', 'tasks-page',
      'goals-menu', 'goals-dashboard-page',
      'finance-menu', 'finance-overview-page', 'finance-overview-export', 'finance-overview-refresh',
      'finance-projects-page', 'finance-projects-create', 'finance-projects-edit', 'finance-projects-delete',
      'finance-categories-page', 'finance-categories-create', 'finance-categories-edit', 'finance-categories-delete',
      'finance-costs-page', 'finance-costs-create', 'finance-costs-edit', 'finance-costs-delete',
      'finance-allocations-page', 'finance-allocations-create', 'finance-allocations-edit', 'finance-allocations-delete',
      'finance-revenue-page', 'finance-revenue-create', 'finance-revenue-edit', 'finance-revenue-delete', 'finance-revenue-export',
      'finance-expenses-page', 'finance-expenses-create', 'finance-expenses-edit', 'finance-expenses-delete', 'finance-expenses-approve', 'finance-expenses-export',
      'finance-accounts-page', 'finance-accounts-create', 'finance-accounts-edit', 'finance-accounts-delete', 'finance-accounts-export',
      'assets-menu', 'assets-overview-page', 'assets-procurement-orders-page', 'assets-procurement-orders-approve', 'assets-procurement-receipts-page', 'assets-procurement-receipts-confirm',
      'data-all',
    ],
    memberCount: 2,
    createdAt: '2024-01-01T00:00:00.000Z',
    updatedAt: '2024-01-01T00:00:00.000Z',
  },
  {
    id: 'hr-manager',
    name: 'HR经理',
    code: 'HR_MANAGER',
    description: 'HR经理，负责人力资源管理',
    status: 'active',
    isSystem: false,
    isProtected: false,
    permissions: [
      'dashboard-menu', 'dashboard-page', 'dashboard-export',
      'organization-menu', 'departments-page', 'departments-create', 'departments-edit', 'departments-delete', 'departments-move',
      'teams-page', 'teams-create', 'teams-edit', 'teams-delete', 'teams-assign-members',
      'permissions-page', 'roles-create', 'roles-edit', 'permissions-assign', 'members-assign-roles',
      'members-page', 'members-create', 'members-edit', 'members-delete', 'members-export', 'members-import',
      'tasks-menu', 'tasks-page', 'tasks-create', 'tasks-assign',
      'goals-menu', 'goals-dashboard-page', 'goals-dashboard-export',
      'personal-goals-page', 'personal-goals-create', 'personal-goals-edit', 'personal-goals-export',
      'finance-menu', 'finance-overview-page', 'finance-revenue-page', 'finance-expenses-page',
      'assets-menu', 'assets-overview-page', 'assets-list-page',
      'data-all',
    ],
    memberCount: 1,
    createdAt: '2024-01-01T00:00:00.000Z',
    updatedAt: '2024-01-01T00:00:00.000Z',
  },
  {
    id: 'disabled-role',
    name: '已禁用角色',
    code: 'DISABLED_ROLE',
    description: '测试用禁用角色',
    status: 'inactive',
    isSystem: false,
    isProtected: false,
    permissions: ['organization-menu', 'members-page'],
    memberCount: 0,
    createdAt: '2024-01-01T00:00:00.000Z',
    updatedAt: '2024-12-01T00:00:00.000Z',
  },
];

// 用户角色关联数据
export const userRoles: UserRole[] = [
  {
    id: 'ur-1',
    userId: '1', // 张三
    roleId: 'super-admin',
    assignedBy: '1',
    assignedAt: '2024-01-01T00:00:00.000Z',
  },
  {
    id: 'ur-2',
    userId: '2', // 李四
    roleId: 'admin',
    assignedBy: '1',
    assignedAt: '2024-01-01T00:00:00.000Z',
  },
  {
    id: 'ur-3',
    userId: '3', // 王五
    roleId: 'department-manager',
    assignedBy: '1',
    assignedAt: '2024-01-01T00:00:00.000Z',
  },
  {
    id: 'ur-4',
    userId: '4', // 赵六
    roleId: 'team-leader',
    assignedBy: '1',
    assignedAt: '2024-01-01T00:00:00.000Z',
  },
  {
    id: 'ur-5',
    userId: '5', // 钱七
    roleId: 'employee',
    assignedBy: '1',
    assignedAt: '2024-01-01T00:00:00.000Z',
  },
  {
    id: 'ur-6',
    userId: '6', // 孙八
    roleId: 'finance-manager',
    assignedBy: '1',
    assignedAt: '2024-01-01T00:00:00.000Z',
  },
  {
    id: 'ur-7',
    userId: '7', // 周九
    roleId: 'hr-manager',
    assignedBy: '1',
    assignedAt: '2024-01-01T00:00:00.000Z',
  },
  // 多角色示例
  {
    id: 'ur-8',
    userId: '3', // 王五同时拥有团队负责人角色
    roleId: 'team-leader',
    assignedBy: '1',
    assignedAt: '2024-02-01T00:00:00.000Z',
  },
];

// 权限冲突处理规则
export interface PermissionConflictRule {
  id: string;
  name: string;
  description: string;
  priority: number; // 优先级，数字越大优先级越高
  type: 'allow' | 'deny';
}

export const conflictRules: PermissionConflictRule[] = [
  {
    id: 'explicit-deny',
    name: '显式拒绝优先',
    description: '显式拒绝权限优先于允许权限',
    priority: 100,
    type: 'deny',
  },
  {
    id: 'max-permission',
    name: '最大权限集合',
    description: '多个角色的权限按最大集合原则合并',
    priority: 50,
    type: 'allow',
  },
];

// 获取用户的所有角色
export const getUserRoles = (userId: string): Role[] => {
  const userRoleIds = userRoles.filter(ur => ur.userId === userId).map(ur => ur.roleId);
  return roles.filter(role => userRoleIds.includes(role.id) && role.status === 'active');
};

// 获取用户的合并权限
export const getUserPermissions = (userId: string): string[] => {
  const userRoleList = getUserRoles(userId);
  const allPermissions = new Set<string>();
  
  userRoleList.forEach(role => {
    role.permissions.forEach(permission => {
      allPermissions.add(permission);
    });
  });
  
  return Array.from(allPermissions);
};

// 检查用户是否有特定权限
export const hasPermission = (userId: string, permissionCode: string): boolean => {
  const userPermissions = getUserPermissions(userId);
  return userPermissions.includes(permissionCode);
};

// 获取角色关联的用户
export const getRoleUsers = (roleId: string): User[] => {
  const roleUserIds = userRoles.filter(ur => ur.roleId === roleId).map(ur => ur.userId);
  return users.filter(user => roleUserIds.includes(user.id));
};

// 权限统计数据
export const getPermissionStatistics = () => {
  return {
    totalRoles: roles.length,
    activeRoles: roles.filter(r => r.status === 'active').length,
    systemRoles: roles.filter(r => r.isSystem).length,
    totalPermissions: permissions.length,
    functionPermissions: permissions.filter(p => p.type === 'function').length,
    dataPermissions: permissions.filter(p => p.type === 'data').length,
    totalUserRoles: userRoles.length,
    usersWithMultipleRoles: new Set(userRoles.map(ur => ur.userId)).size,
  };
};
